# CPU 스케줄링 개요

운영체제가 프로세스들에게 공정하고 합리적으로 CPU 자원을 배분하는 것을 CPU 스케줄링이라고 한다

## 프로세스 우선순위

단순히 생성 순으로 하기에는 프로세스 마다의 우선순위가 다르다

대표적으로 입출력 작업이 많은 프로세스가 우선 순위가 높다

- 대부분의 프로세스들은 CPU와 입출력장치를 모두 사용하여 실행된다 -> 프로세스는 실행 상태와 대기 상태를 반복하며 실행된다.
- 그런데 프로세스 종류마다 입출력 장치를 이용하는 시간과 CPU를 이용하는 시간의 양에는 차이가 있다
  - 입출력 집중 프로세스 : 비디오 재생이나 디스크 백업 작업처럼 입출력 작업(입출력 버스트)이 많은 것
    - 실행 상태보다는 입출력을 위한 대기 상태에 더 많이 머무르게 된다
  - CPU 집중 프로레스 : 복잡한 수학 연산, 컴파일, 그래픽 처리 작업 처럼 CPU 작업(CPU 버스트)이 많은 것
    - 대기 상태보다는 실행 상태에 더 많이 머무르게 된다

-> 그래서 빨리 실행시켜 입출력 장치를 끊임없이 작동시키도 다음 CPU 집중 프로세스에 집중적으로 CPU를 할당하는 것이 더 효율적임

운영체제는 프로세스마다 우선순위를 부여한다. 각 프로세스의 PCB에 우선순위를 명시하고 PCB에 적힌 우선순위를 기준으로 먼저 처리할 프로세스를 결정한다

## 스케줄링 큐

우선순위가 적혀 있다고 하여도 운영체제가 CPU를 사용할 다음 프로세스를 찾기 위해 모든 프로세스의 PCB를 뒤지는 것은 비효율적 </br>

CPU 뿐만아니라 다른 자원들을 사용해야할 때도 마찬가지
그렇기에 스케줄링 큐로 프로세스들을 줄 세워둔다 </br>

대표적인 큐

- 준비 큐 : CPU를 이용하고 싶은 프로세스들이 서는 줄
- 대기 큐 : 입출력 장치를 이용하기 위해 대기 상태에 접어든 프로세스들이 서는 줄

## 선점형과 비선점형

프로세스가 CPU를 사용하는 중에 다른 프로세스가 CPU 자원을 요청했을 때 처리 방법

1. 선점형 프로세스

- 현재 프로세스의 CPU를 뺴앗아서 사용
- 장점: 지원 독점을 막고 프로세스들에 골고루 자원을 배분 가능
- 단점: 문맥 교환 과정에서 오버헤드 발생 가능 존재

2. 비선점형 프로세스
   현재 프로세스가 다 사용할 때까지 기다리기

# 비선점 CPU 스케줄링 알고리즘

## 선입 선출 스케줄링 FCFS

준비 큐에 삽입된 순서대로 프로세스들을 처리하는 비선점형 스케줄링 방식
프로세스들이 기다리는 시간이 매우 길어질 수 있다

- **호위 효과**
- 앞선 프로세스가 실행시간이 길다면 실행시간이 짧은 프로세스들이 실행되지 못해 마치 부하처럼 뒤따라서 기다리고 있는 것

## 최단 작업 우선 스케줄링 SJF

CPU 사용 시간이 짧은 간단한 프로세스를 먼저 실행

# 선점형 CPU 스케줄링 알고리즘

## 라운드 로빈 스케줄링

선입 선출 스케줄링에서 타임 슬라이스라는 개념이 더해진 스케줄링 방식

- 타임 슬라이스: 각 프로세스가 CPU를 사용할 수 있는 정해진 시간을 의미

큐에 삽입된 프로세스들은 삽입된 순서대로 CPU를 이용하되 정해진 시간만큼 CPU를 이용하고 아직 프로레스가 완료되지 않았다면 다시 큐의 맨 뒤에 삽입한다

라운드 로빈은 타임 슬라이스 크기가 매우 중요

- 타임 슬라이스가 크면 선입 선출과 다를 바 업고, 작으면 문맥 교환에 발생하는 비용이 크기가 크다

## 최소 잔여 시간 우선 스케줄링 SRT

SJF, 라운드 로인이 결합된 방식
프로세스들은 정해진 타임 슬라이스만큼 CPU를 사용하되 CPU를 사용할 다음 프로세스로는 남아있는 작업 시간이 가장 적은 프로세스가 선택된다

## 우선순위 스케줄링

프로세스들에 우선순위를 부여하고, 가장 높은 우선순위를 가진 프로세스부터 실행하는 스케줄링 알고리즘
단점 : 우선 순위가 낮은 프로세스는 계속 연기가된다 이를 기아 상태라고 한다
이를 해결하기 위한 기법으로 에이징이 있다

- 오랫동안 대기한 프로세스의 우선순위를 점차 높이는 방식

## 다단계 큐 스케줄링

우선순위별로 준비 큐를 여러개 사용하는 스케줄링 방식이다
우선순위가 높은 큐에서 있는 높은 친구를 먼저처리
높은 큐가 다 비어있으면 그 다음 우선 순위 큐에 있는 프로세스 처리 </br>

장점

- 프로세스 유형별로 우선순위를 구분하여 실행하는 것이 편리해짐
- 큐 별로 타임 슬라이스를 여러 개 지정할 수 있고, 큐마다 다른 스케줄링 알고리즘을 사용할 수도 있다고

## 다단계 피드백 큐 스케줄링

다단계 큐는 큐 사이를 이동할 수 없다.

- 이렇게 되면 우선 순위가 낮은 프로세스는 계속 연기될 수 있다 (기아 상태 발생)

다단계 큐 스케줄링과 비슷하지만 큐 사이를 이동할 수 있다

- 만약 오래걸리는 프로세스가 있다면 타임슬라이스 동안 실행되다가 다음 우선 순위 큐에 삽입되는 형식을 반복하면서 점차 CPU를 오래 사용하는 프로세스는 우선순위가 낮아진다
  그럼 CPU를 비교적 작게 사용하는 입출력 집중 프로세스들의 우선 순위가 높아진다

또한, 낮은 우선 순위 큐에서 오래 기다리고 있는 프로세스들은 점차 우선 순위가 높은 큐로 이동 시키느 에이징 기법을 적용하여 기아 현상을 예방할 수 있다
